Here is the complete text file for practicals 19, 20, 21, and 22.

You can copy all of this into a single `.txt` file.

-----

## START OF FILE mongo_practicals.txt

MongoDB Practicals (Q19-Q22)

First, run `mongosh` in your terminal.
Then, type `use PracticalExamDB` to create and switch to your database.

-----

-----

### PRACTICAL 19 Employee Collection (employee)

 --- 1. Insert Data (Copy this whole block) ---

```javascript
db.employee.insertMany([
    { employee_id 1, first_name John, last_name Doe, department IT, salary 60000, hire_date new Date(2021-05-15), position Software Engineer },
    { employee_id 2, first_name Jane, last_name Smith, department HR, salary 55000, hire_date new Date(2020-03-10), position HR Specialist },
    { employee_id 3, first_name Alex, last_name Johnson, department IT, salary 70000, hire_date new Date(2019-09-22), position DevOps Engineer },
    { employee_id 4, first_name Emily, last_name Davis, department Finance, salary 80000, hire_date new Date(2021-02-18), position Analyst },
    { employee_id 5, first_name David, last_name Duck, department IT, salary 40000, hire_date new Date(2020-06-05), position Software Engineer },
    { employee_id 6, first_name Don, last_name Dev, department Finance, salary 90000, hire_date new Date(2019-08-03), position Developer }
]);
```

 --- 2. Run Queries ---

 1. Find All Employees.

```javascript
db.employee.find({});
```

 2. Find Employees in IT department.

```javascript
db.employee.find({ department IT });
```

 3. Find Employees in Finance with salary greater than 85000.

```javascript
db.employee.find({ department Finance, salary { $gt 85000 } });
```

 4. Count the Number of Employees in Each Department.

```javascript
db.employee.aggregate([
    { $group { _id $department, count { $sum 1 } } }
]);
```

 5. Calculate the Average Salary in Each Department.

```javascript
db.employee.aggregate([
    { $group { _id $department, averageSalary { $avg $salary } } }
]);
```

 6. Find Employees Hired After a Certain Date (e.g., 2021-01-01).

```javascript
db.employee.find({ hire_date { $gt new Date(2021-01-01) } });
```

 7. Update Salary of All Employees in IT by 50000.

```javascript
db.employee.updateMany(
    { department IT },
    { $inc { salary 50000 } }
);
```

 8. Delete an Employee Record by id=6.

```javascript
db.employee.deleteOne({ employee_id 6 });
```

 9. Find the Highest Salary in Each Department.

```javascript
db.employee.aggregate([
    { $group { _id $department, maxSalary { $max $salary } } }
]);
```

 10. Count Employees in Depts with More Than 1 Employee.

```javascript
db.employee.aggregate([
    { $group { _id $department, count { $sum 1 } } },
    { $match { count { $gt 1 } } }
]);
```

 --- Explanation for Q19 ---
This practical tests basic MongoDB commands.

   `db.collection.find()` is used for `SELECT` and `WHERE`.
   `db.collection.updateMany()` and `db.collection.deleteOne()` modify data.
   `db.collection.aggregate()` is used for grouping (`$group`) and calculations (`$sum`, `$avg`, `$max`). The `$match` stage is used to filter after grouping (like `HAVING` in SQL).

-----

-----

### PRACTICAL 20 Student Collection (student)

 --- 1. Insert Data (Copy this whole block) ---

```javascript
db.student.insertMany([
    { student_id 1, first_name John, last_name Doe, age 20, grade A, major Computer Science },
    { student_id 2, first_name Jane, last_name Smith, age 21, grade B, major Mathematics },
    { student_id 3, first_name Alex, last_name Johnson, age 22, grade A, major Physics },
    { student_id 4, first_name Emily, last_name Davis, age 23, grade C, major Biology },
    { student_id 5, first_name David, last_name Duck, age 21, grade B, major Mathematics },
    { student_id 6, first_name Don, last_name Dev, age 22, grade A, major Mathematics }
]);
```

 --- 2. Run Queries ---

 1. Find All Students.

```javascript
db.student.find({});
```

 2. Find Students in a Specific Major (Computer Science).

```javascript
db.student.find({ major Computer Science });
```

 3. Count the Number of Students in Each Major.

```javascript
db.student.aggregate([
    { $group { _id $major, count { $sum 1 } } }
]);
```

 4. Find Students with a Specific Grade (A).

```javascript
db.student.find({ grade A });
```

 5. Count Students in Each Grade Having More Than 2 Students.

```javascript
db.student.aggregate([
    { $group { _id $grade, count { $sum 1 } } },
    { $match { count { $gt 2 } } }
]);
```

 6. List Students Ordered by Age.

```javascript
db.student.find({}).sort({ age 1 });
```

 7. Update a Student's Major (Emily).

```javascript
db.student.updateOne(
    { first_name Emily },
    { $set { major Physics } }
);
```

 8. Find the Oldest Student.

```javascript
db.student.find({}).sort({ age -1 }).limit(1);
```

 9. Find the Eldest Student (Same as #8).

```javascript
db.student.find({}).sort({ age -1 }).limit(1);
```

 10. Delete a Student Record by student_id=6.

```javascript
db.student.deleteOne({ student_id 6 });
```

 --- Explanation for Q20 ---
This practical adds `sort()` and `limit()` to the `find()` command.

   `.sort({ age 1 })` means sort by age, ascending (1 to 100).
   `.sort({ age -1 })` means sort by age, descending (100 to 1).
   `.limit(1)` just gets the top record after sorting, which is how you find the min or max.
   `updateOne` is used to change a single document.

-----

-----

### PRACTICAL 21 Employee Collection 2 (emp)

 --- 1. Insert Data (Copy this whole block) ---

```javascript
db.emp.insertMany([
    { emp_id 1, emp_name Anuja, dept_name Comp, salary 20000, gender F },
    { emp_id 2, emp_name Khushi, dept_name Comp, salary 40000, gender M },
    { emp_id 3, emp_name Jayesh, dept_name It, salary 30000, gender F },
    { emp_id 4, emp_name Lokesh, dept_name It, salary 60000, gender M },
    { emp_id 5, emp_name Bhushan, dept_name Etc, salary 50000, gender F },
    { emp_id 6, emp_name Manisha, dept_name Etc, salary 90000, gender M }
]);
```

 --- 2. Run Queries ---

 1. Display all the record.

```javascript
db.emp.find({});
```

 2. Display different Department name through aggregation.

```javascript
db.emp.aggregate([
    { $group { _id $dept_name } }
]);
```

 3. Find department wise total employees.

```javascript
db.emp.aggregate([
    { $group { _id $dept_name, total_employees { $sum 1 } } }
]);
```

 4. Find department wise total salary.

```javascript
db.emp.aggregate([
    { $group { _id $dept_name, total_salary { $sum $salary } } }
]);
```

 5. Find department wise total salary of female employee.

```javascript
db.emp.aggregate([
    { $match { gender F } },
    { $group { _id $dept_name, total_salary_female { $sum $salary } } }
]);
```

 6. Find department wise count of male employee.

```javascript
db.emp.aggregate([
    { $match { gender M } },
    { $group { _id $dept_name, total_male_employees { $sum 1 } } }
]);
```

 7. Find the total male employees.

```javascript
db.emp.countDocuments({ gender M });
```

 8. Find Minimum salary in the institute.

```javascript
db.emp.aggregate([
    { $group { _id Institute, minSalary { $min $salary } } }
]);
```

 9. Find maximum salary in the department of Comp.

```javascript
db.emp.aggregate([
    { $match { dept_name Comp } },
    { $group { _id Comp Dept, maxSalary { $max $salary } } }
]);
```

 10. Find all male employee sort in ascending order of Emp-Name.

```javascript
db.emp.find({ gender M }).sort({ emp_name 1 });
```

 --- Explanation for Q21 ---
This practical is all about the Aggregation Pipeline. The key pattern is combining `$match` and `$group`.

   `$match` filters documents before they are grouped (like SQL `WHERE`).
   `$group` performs the `SUM`, `AVG`, `MIN`, `MAX` calculations.
   Notice in Q5 and Q6, you `$match` for gender first, then `$group` by department.

-----

-----

### PRACTICAL 22 Map-Reduce (on 'emp' collection)

 --- 1. Define the Map function (Copy this whole block) ---

```javascript
var mapFunction = function() {
    emit(salary_stats, { 
        total this.salary, 
        min this.salary, 
        max this.salary, 
        count 1 
    });
};
```

 --- 2. Define the Reduce function (Copy this whole block) ---

```javascript
var reduceFunction = function(key, values) {
    var reduced = { total 0, min Infinity, max -Infinity, count 0 };
    
    values.forEach(function(val) {
        reduced.total += val.total;
        reduced.min = Math.min(reduced.min, val.min);
        reduced.max = Math.max(reduced.max, val.max);
        reduced.count += val.count;
    });

    return reduced;
};
```

 --- 3. Run Map-Reduce (This creates a new collection) ---

```javascript
db.emp.mapReduce(
    mapFunction,
    reduceFunction,
    { out map_reduce_results }
);
```

 --- 4. Show the final result ---

```javascript
db.map_reduce_results.find();
```

 --- Explanation for Q22 ---
This practical uses the old Map-Reduce framework.

1.  Map The `mapFunction` is run on every document in `db.emp`. It `emit`s a key (salary_stats) and a value (an object with this doc's salary).
2.  Reduce The `reduceFunction` takes all the values with the same key and reduces them down to one object, calculating the total, min, and max.
3.  Run The `db.emp.mapReduce` command runs the process and saves the final result into a new collection named `map_reduce_results`.
4.  View You must `find()` on the new collection to see the answer.

-----

## END OF FILE